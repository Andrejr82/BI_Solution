{
  "timestamp": 1760430127.310655,
  "response": {
    "content": "```python\n# Passo 1: Carregar dados\ndf = load_data()\n\n# Passo 2: Responder à pergunta \"Dashboard executivo: KPIs principais por segmento\"\n# Calculando as vendas totais por segmento\nvendas_por_segmento = df.groupby('NOMESEGMENTO')['VENDA_30DD'].sum().reset_index()\nvendas_por_segmento = vendas_por_segmento.rename(columns={'VENDA_30DD': 'VENDAS_TOTAIS'})\n\n# Calculando o estoque total por segmento\nestoque_por_segmento = df.groupby('NOMESEGMENTO')['ESTOQUE_UNE'].sum().reset_index()\nestoque_por_segmento = estoque_por_segmento.rename(columns={'ESTOQUE_UNE': 'ESTOQUE_TOTAL'})\n\n# Calculando o número de produtos únicos por segmento\nprodutos_por_segmento = df.groupby('NOMESEGMENTO')['PRODUTO'].nunique().reset_index()\nprodutos_por_segmento = produtos_por_segmento.rename(columns={'PRODUTO': 'NUMERO_PRODUTOS'})\n\n# Calculando o preço médio por segmento\npreco_medio_por_segmento = df.groupby('NOMESEGMENTO')['LIQUIDO_38'].mean().reset_index()\npreco_medio_por_segmento = preco_medio_por_segmento.rename(columns={'LIQUIDO_38': 'PRECO_MEDIO'})\n\n# Juntando todos os KPIs em um único dataframe\nkpis_principais = vendas_por_segmento.merge(estoque_por_segmento, on='NOMESEGMENTO')\nkpis_principais = kpis_principais.merge(produtos_por_segmento, on='NOMESEGMENTO')\nkpis_principais = kpis_principais.merge(preco_medio_por_segmento, on='NOMESEGMENTO')\n\n# Passo 3: Salvar resultado\nresult = kpis_principais\n```"
  },
  "metadata": {
    "model": null,
    "temperature": 0,
    "query_hash": "2f6d9e27e84e359a30518ebb0dd45977"
  }
}