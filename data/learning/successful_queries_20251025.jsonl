{"timestamp": "2025-10-25T19:56:42.442581", "query": "\n            **TAREFA:** Você deve escrever um script Python para responder à pergunta do usuário.\n\n            **INSTRUÇÕES OBRIGATÓRIAS:**\n            1. **CARREGUE OS DADOS:** Inicie seu script com a linha: `df = load_data()`\n            2. **RESPONDA À PERGUNTA:** Usando o dataframe `df`, escreva o código para responder à seguinte pergunta: \"quais produtos estão sem vendas na une nig\"\n            3. **SALVE O RESULTADO NA VARIÁVEL `result`:** A última linha do seu script DEVE ser a atribuição do resultado final à variável `result`. Esta é a única forma que o sistema tem para ver sua resposta. NÃO use `print()`.\n\n            **Exemplo de Script:**\n            ```python\n            # Passo 1: Carregar dados\n            df = load_data()\n\n            # Passo 2: Responder à pergunta (ex: \"ranking de vendas do segmento tecidos\")\n            tecidos_df = df[df['NOMESEGMENTO'].str.upper() == 'TECIDO']\n            ranking = tecidos_df.groupby('NOME')['VENDA_30DD'].sum().sort_values(ascending=False).reset_index()\n\n            # Passo 3: Salvar resultado\n            result = ranking\n            ```\n\n            **Seu Script Python (Lembre-se, a última linha deve ser `result = ...`):**\n            ", "code": "# Passo 1: Carregar dados\ndf = load_data()\n\n# Passo 2: Responder à pergunta \"quais produtos estão sem vendas na une nig\"\n# Produtos sem vendas são aqueles com estoque maior que 0 e vendas nos últimos 30 dias igual a 0.\n# Filtrar pela loja 'NIG'\ndf_nig = df[df['UNE'] == 'NIG'].copy()\n\n# Tratar possíveis valores NA em ESTOQUE_UNE e VENDA_30DD antes de comparar\ndf_nig['ESTOQUE_UNE'] = df_nig['ESTOQUE_UNE'].fillna(0)\ndf_nig['VENDA_30DD'] = df_nig['VENDA_30DD'].fillna(0)\n\n# Identificar produtos sem vendas: estoque > 0 e vendas = 0\nsem_vendas_nig = df_nig[(df_nig['ESTOQUE_UNE'] > 0) & (df_nig['VENDA_30DD'] == 0)]\n\n# Selecionar colunas relevantes para o resultado\nresult = sem_vendas_nig[['PRODUTO', 'NOME', 'NOMESEGMENTO', 'ESTOQUE_UNE', 'VENDA_30DD']]", "rows": 3613, "success": true}
