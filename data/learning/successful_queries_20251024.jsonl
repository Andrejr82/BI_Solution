{"timestamp": "2025-10-24T20:51:20.632492", "query": "\n            **TAREFA:** Você deve escrever um script Python para responder à pergunta do usuário.\n\n            **INSTRUÇÕES OBRIGATÓRIAS:**\n            1. **CARREGUE OS DADOS:** Inicie seu script com a linha: `df = load_data()`\n            2. **RESPONDA À PERGUNTA:** Usando o dataframe `df`, escreva o código para responder à seguinte pergunta: \"quais tecidos estao sem giro e em qual unes?\"\n            3. **SALVE O RESULTADO NA VARIÁVEL `result`:** A última linha do seu script DEVE ser a atribuição do resultado final à variável `result`. Esta é a única forma que o sistema tem para ver sua resposta. NÃO use `print()`.\n\n            **Exemplo de Script:**\n            ```python\n            # Passo 1: Carregar dados\n            df = load_data()\n\n            # Passo 2: Responder à pergunta (ex: \"ranking de vendas do segmento tecidos\")\n            tecidos_df = df[df['NOMESEGMENTO'].str.upper() == 'TECIDO']\n            ranking = tecidos_df.groupby('NOME')['VENDA_30DD'].sum().sort_values(ascending=False).reset_index()\n\n            # Passo 3: Salvar resultado\n            result = ranking\n            ```\n\n            **Seu Script Python (Lembre-se, a última linha deve ser `result = ...`):**\n            ", "code": "# Passo 1: Carregar dados\ndf = load_data()\n\n# Passo 2: Responder à pergunta\n# Mapear \"tecidos\" para o valor exato da coluna NOMESEGMENTO\nsegmento_tecidos = 'TECIDOS'\n\n# Filtrar produtos do segmento TECIDOS com estoque zero\nsem_giro_tecidos = df[(df['NOMESEGMENTO'] == segmento_tecidos) & (df['ESTOQUE_UNE'] == 0)]\n\n# Agrupar por UNE e contar a quantidade de produtos sem giro em cada uma\n# Usar .reset_index() para converter o resultado do groupby em DataFrame\ncontagem_sem_giro_por_une = sem_giro_tecidos.groupby('UNE')['PRODUTO'].count().reset_index()\n\n# Renomear colunas para clareza\ncontagem_sem_giro_por_une.columns = ['UNE', 'Produtos Sem Giro']\n\n# Selecionar as colunas relevantes para o resultado final\nresult = contagem_sem_giro_por_une[['UNE', 'Produtos Sem Giro']]", "rows": 1, "success": true}
